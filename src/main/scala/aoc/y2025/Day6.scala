package aoc.y2025

object Day6:
  def solve(input: String): Long =
    val problems = input.linesIterator.toVector
    val nums     = problems.init.map(line => "\\d+".r.findAllIn(line).map(_.toLong).toVector)
    val ops      = "[+*]".r
      .findAllIn(problems.last)
      .map:
        case "+" => (vec: Vector[Long]) => vec.sum
        case "*" => (vec: Vector[Long]) => vec.product
      .toVector

    nums.transpose.zip(ops).map((vec, op) => op(vec)).sum

  def solve2(input: String): Long =
    input.linesIterator.toVector.transpose.reverse
      .foldLeft(Nil: List[List[Long]]):
        case (Nil, line)                             => (line.filterNot(_.isWhitespace).mkString.toLong :: Nil) :: Nil
        case (acc :: tail, line) if line.last == '+' =>
          Nil :: ((line.filterNot(_.isWhitespace).init.mkString.toLong :: acc).sum :: Nil) :: tail
        case (acc :: tail, line) if line.last == '*' =>
          Nil :: ((line.filterNot(_.isWhitespace).init.mkString.toLong :: acc).product :: Nil) :: tail
        case (acc, line) if line.forall(_.isWhitespace) => acc
        case (acc :: tail, line) => (line.filterNot(_.isWhitespace).mkString.toLong :: acc) :: tail
      .flatten
      .sum

  val input =
    """466 4   959  38 9  64 6664 96 946 235 8    55 427   71 77 826 61   19 923 39 64 51 2529 1   8 671 928 12   5 259 54 968 178  489 1   69  32 2356 7     1 391  396 57 384 676 69 459 8951  727 927 6  726 675 776 93 343 4985 2246 95   8 1  12  115   79 98 412  16 3   66 2    7   89 5235 769 91  2   7 7447 447   7 19 36 644 27  4 7  936 11 92   94 5     25 198 164 4232  9 38 41 44   44 99  41 57 99 778 9  42 69  17  44 1   394 127 73   6262 28 15 231 5792 5  437 282 926 3416   19 9811  143 76 35 3683 926  37 72 84 59 8    5  3 4   68 756 7995 2   778 32 17 68 6335 8  622  8171 16  8   32 597 799 587 97 527   34 298 56 773 1  2  41 7    1 4348 492 782 123 7418 73 3     443 1  88 61  93 6  9   99 94 15 615 76 42  981 13  598 75 38 75 149 5383 75 76 8  12 87  499  8 321 31 375 18  51 9966 62  1359 2  87 12 42 7888 1  2  582 36 126 841 984 123 1532 449 786 544   39 2  3  284   73  5 81 514 47 96 75  75  57   94  34 8     3 91    93 5    7 18  239 67  35 671 17 8  9   46 884 22   7 988 24 53 18   417 889 71 4288 354 83   6 11 496 227 53  75 8862 86 32 1   55   8 91   257 61 639 248 893  993 563 73 76 215 995 74   8 774 8118  5  93   46 9  6773 91 86 17 292 39 12    5 86  7 12  2  195 83 568 3339  3 87 227  1 52 151 636 12 479  64 58   726 91 464 92   7752  41 66  916  41 8233 73 59 62 548 328 483  11 44 5543 31  7 863 416 12  3 143 78 26  561 25  623   1   91 29 5   96 847 984  54   4 618 78   3 17 25 66 2  78 5    28 89  34 46  95 98 428 93  64 9682 19 826 858 58 15 7   3 71 2  699 23 85 92 42 718 36 981 799 11 594 18 272 3  69 41 121 99  693 64   184 495 51 38 35 82 41 114  4 37 98 131 18   25 81   3 633 56 6    7   5  14 449 17 36 62  95  14 5839 2722 12 99 2165 7216 12   13 43 74 7    91 71  98 11 24 4      6 65   77 52 818 76  16 94 94 787 7    3 31  65 92 728 2  77  464 93 39  581   2 395 97 79   16  939 79 48 93 9  51 68  2 34   28 397  1 32  6  875 9131 6273  4 367 44 8572 1119 98     3 1  88  4 695 19 1944 547 9  6963 3  18  21 923   84 444 66 41  8 381 42 932 8592 967 41  7236 63 68 63  168 44  3 338 117 6153 784 78  1 43 34  616 835 395 9     8 72 623 1   2   79 492 37  11 46 653 59 285 16     5  54 7    2431 42 816 524 87  68 1  334 87 57    28 6     7 25 52 863 9  795 71 522 32 4559 62 47 37 6537 58   9 52 54 29  89 1   39 94 295 194  1 39 68 2  72  86   68 254 781   75 14 7  86 9793 29 96   4 82 5897  79  5 25 2413 3   3   41  58 82 3329 52  8   32 336 6583  577 13 67 17  5318 69 17  59 88  7 3  18 9131 15 129 9956 55 5    859 759 5   1677 189 45   49 1  41 25  28   975 266 42  26 5  53 726  43 74  29 646   1 983  79  73 9551 44   75 5  73  46 575 93 755 9619   9 6      1 6874 533 2256 43 7247 72 89 292 913 67 6445 6988 29  35 7  47 18 42 42 948  4  557  55 279 454 887 6  13  4 1686 9  8532 43 657 4  56 81 92  93 31 963   3 943 7  83  4324 18  42 99 53 166  6 9    37 7553 962  3 78 964 99  443   74 69 42 54  48 32 81 247 325  38 31 469 37  5 915 4157 986 736 59 93 1538 3269 49 85  8264 73  134  96 55  2 78 51    8  6  9 4422 68  47 74  74  2 54 869  4 299 834 269 654 545 4746 3   69 481 883  8833   2 46  8    4 54 838 348   4 226 2  843  8 469 6874 8  61 39 88 41 62  36  6 2999 65   3 8443 38 33 48 1   47 213 74   5363  35 59   7 9229 51  8 741  1   955 665 567 27 498  1 12 154 14 63 521 25 1  859  99 682 886 84  8  44   69  97 3   83 48  211 59   37 69 3345   9 843 83 17 65  6 26  5 38  5 8  86      8 89  3   142 88 394 6  773 55   1 7   2 612  97   52 975  31 253   97 71 228  17 171   47  3 638 791 4  241 748 38 971 6  42  63  896   5 61 75 366 7  7145 7   91 48 7    147 666 6467 487 49 87 315 96  75  99 48 78  15 811 76 9  95   3 3791 13  4  14   2 656  984 2   51 621 356 499 2269 1  86 9152 686  8  41 245 29  7 58 53 3  463 47  5 85 1  175 986 1121 82
      |819 95  1621 22 27 65 6644 76 697 854 162 561 553 8999 51 663 7571 71 415 91 52 25 9111 7  82 869 163 45  31 394 95 642 8567 771 81 787 448 971  947   2 1489 639 23 826 957 83  12 446   947 776 64 249 299 397 65 672 7847 4577 966  8 71 41  322  655 79 524  51 54  31 8911 557 83 2796 494 33  7  48 2349 742 615 78 59 156 9  44 2  17  69 18  366 8    142 739  56 1244  7 63 77 456  61 19  81 18 44 358 42  2 57 947 498 982 833 678 373  5682 15 93 559 6236 23 947 566 865 8489  453  144  448 27 88 526  864  29 81 97 1  16  44  3 33  73 911 3852 586 249 24 66 58 8277 8  434  7627 419 38  47 922 176 624 34 433 1171 126 2  934 55 14 18 222  3  924 455 364 291 7869 66 34   4297 44 15 278 37 4  861 35 71 82 445 62 282 588 96  587 46  3 18 751 6441 97 52 3  75 289 253  4 378 41 567 34  27  515 71  1973 71 85 69 16 4591 4  19 514 58 795 384 252 112 3574  41 842 779 5529 99 43 377 6318 33 64 745 63 45 17  13  983 697 671 6    87 8678 396 98  91 439 429 986 6  462 11 58 15  14 647 15   2 237 97 43 3784 777 876 74 4114 998 27 653 49 116 923 92  41 1145 79 89 2  584 989 8926 713 34 462  41 961  282 739 96 15 741 595 8  885 615 8714  6 483   22 72 6452 26 95 27 472 23 965  74 76  9 46  3  532 68 726 7143  1 42 718  7 17 175 871 85 556  98 59   116 66 751 76   1375  85 711 399  94 1734 55 71 81 286 238 2986 47 87 9416 98  8 141 758 76  9 297 41 24  369 695 111  27  343 56 42  68 389 693  93 837 336 98  95 59 35 17 12 66 316  41 49 945 43  52 47 521 189 44 2821 11 217 244 88 67 67 39 56 56 249 4  47 13  8 881 29 574 254 21 174 13 421 97 69 31 773 93    7 346  938 232 56 99 36 37 55 346  5 75 66 263 37   96 83  68 912 56 4932 49 83  31 332 41 15 84  98  76 8616 8217 89 35 2117  879 1112 92 24 56 24  389 61  74 66 19 294   74 3194 29 62 521 261 75 65 83 137 9  633 283 22 29 139 84 57  712 62 31  493  26 768 89 872  35  478 62 88 85 72 51 8  33 979  34 599  4 868 47 312 9535  424 18 474 38 9936 2881 28   241 8  94  3 462 67 195  785 1  5623 3  11  65 495 5623 241  4 54  3 594 38 795 3144 155 76   981 17 66 693 571 18 13 571 515  519 747 94 48 59 14 1416 994 483 427  23 42 587 83  9   22 863 351 8  47 49  43 598 76   416 279 49   1448  9 184 673 15  14 7  49  53 5528  54 4   842 38 77 17  7  675 55 456 54 1398 59 29 47 257  41  68 49 48 463 29 45  52 27 743 228  9 53 96 8  34  43  215 271 73   993 21 1  31 6641 76 49  19 32 8571 244 78 73 9441 32  663 99  17 52 4683 214 348 62 159 3292 6836 94 11 563 7584 31 851 38 53  4 36 52 9196 27 891 5671 73 551  616 616 61  1223 558 43   88 76 54 67  7229 839 438 11  23 9  67 763  98 563 42 474  12 794 762 999 5855 615  73 5  85  31 168 63 734 9519  44 89    19 9718 368 2348 93 6634 23 72 792 289 86 5936 5936 48  68 3  25 97 85  6 466  4  258  51 112 645 946 82 64  2 213  7   532 81  26 84 67 81 541 85 57 883  35 671 24 89  4336 55  55 96 29 691 34 58   47 8563 682 85 32 662 45  515   24 36 44 914 42 32 85 364 354  89 96 526 62 65 758 5269 334 276 27 16 2219 4313 82 73  1334 498 416 299 13 48 73 261   3  2  2 7953 67  89 53  48 32 98 159  8 712 687 331 329 99  9338 318 18 261 659  5258  37 33  617  6 88 881 627  99 683 79 877  9 281 5847 64 64 84 49 96 54  37 25 5453 36   3 2494 16 15 51 983 69 243 713  3623 777 22 317 9291 76 78 6213 663 767 698 174 98 298  6 76 867 61 92 395 3  34  89  46 295 22  855 73 723  686 81 933  9 412 546 28   32 44 6122   9 953 87 98 96  8 53 36 66  4 9  772   378 35  8   238 72 8   65  68 21   8 89  7 915  37 5774 354  97 395 1425 31 431  32 972 1464 91 463 922 26 631 154 87 156 96 732 91  567  73 45 18 618 9  1773 6   57 36 171  925 625 9494 886 81 97 682 19  37  93 65 94  77 155 84 1  84   5 2236 85  1  79 772 298  543 22  37 556 962 715 9689 66 58 9186 841 12 866 916 17  3 83 67 2  685 42 86 53 46 282 112 3384 82
      | 39 428 3812 46 55 14  378 78 176 984 329 348 226 6737 36 894 8935  9 934 2  65 38   73 18 65 331 194 59 756 2   44 745 7169 541 87 629 214 868  125   4 7135 843 7  143 898 71  81 76    754 813 59  42 551 116 68 876 8496 5168 762 76 47  5 3953 1366 97 56  625 676 15 7913 225 27  249 822 87 26  73 2116 241 222 95 18 919 5  81 76 2   86 54 8493 594 7847 26    9 2254  2  9 84 7237  7 47  18 86 71 945 99  4 88 344 875 812 418  92 1915 9424 41 46 54  4699 99 813  45 42  4296 5733  995 5851 82 26 85   293 286 22 28 9  54 432 98 116 28  48   33 362 464 17 16 58  617 92 7712 2165 611 414 17 62  634 928 86  37 6885 6   7  345 23 41 45 549 78  331 694 785 732 8672 83 3826 7184 21 39 387 17 2  812 64 66 2  738 4  751 718 181 582 73  7 39 517  819 76 48 6  22 761 944 76 124 63 412 77  21  472 683  647 82 35 34  1 786  46 97 124 61 381 883  64 245 652   64 38  965 4752 43 38 749 2859 38 68 947 17 6  561 31  817 163 678 883 373 7877 378 474 47 119 425 842 1   64 99 23 39  43  91 13  39 855 17 6  5334 56  398 12 2139 851 33 929 86 696 171 97 657 2145 73 55 81 188 738 7994 89  84 934  89 9143 798 421 55 23 924 44  7  447 27  4598 41 165  774 45 1449 32 46 8   59 41 461 111 14 57 33 26 8838 81 663 512  62 91 414 16 27 645 742 93 841 378 546 9322 56 414 1956 193  468 796 244 895   86 49 94 77 233 255 8442 35 83  516 65 16 897 94  5  11 765 43 55 1686 375 382 643 9323 45 462 71 86  145  96 134  25 55 259 5  71 62 15 95 283 118  2 237 49 645 11 312 899 89  673 99 882  31 17 95 14 85 52 44 124 2  25 27  9 633 52 727 461 52 53  87  18 65 97 89 387 487   7 6389 227 65  11  6 99 69 57 436 35 51 56 886 8   481 416 67 471 45 5471 16 32 211 584  1 93 325 52  32 3525 9939 92 67 683    71 5523 17 33 6  526 417 23 858 63 74 492  224 4773 55 84 735 359 57 51 85 319 52 942 443 58 5  436 61 632 659 94 76  785 949 8   82 312  73 7819 58 55 9  74 58 9  73 677  32 17  84 578 36  16 9325   94 54 365 22 419   299 714  555 38 42  7 192 64 81   483 49 645  9  117 28 216 2177 556  8 2  81 491 11 565 8375 499 934  845 91 82 133 5    7 68 734 197  558 398 37 18 67 17 8858 96  755 461  19 95  68 683 31  67 391 912 9  46 2    7 489 692 8365 736 7573  982  5 929 556 59 186 27 16  12 6889  26 856 457 62 23 86  83 127 78 294 64  431 83 82 24 616  16 233 2  38 317  3 544 4  29 261 621 46 57 87 9  699 39 9841 495 87  9636  9 38 51 8461 28 42  86 13 984  944 82 36 9761 12  427 411 8  24 2681 785 774 89 253 4854 6723 86 11 267 5635 37 317 65 25  7 77 67 312  95 488 2631 24 5253 963 636 561  496 768  4 6979 99 67 71  4725 641 577 218 92 92 13 562  52 692 72 8243 48 464 628 246  586 552 773 15 37 625 749 25 87  721   42 9833  23 1432 883 7976 77 1887 29 52 331 794 96 5434 3619 996 27 73 67 72 12  4 2536 56 567   8 277 476 778 81 91 73 32   36  481 86  27 45 12 41 628 2  22 175 386 591 55 375  728 15 946 79 84 133 11 6361 88 6434 569 43 52  72 541 9967 373 62 89 658 14 57 45 24  3397 92 2  923 63 38 513 6247  99 526 82 69 23   3526 56 631 5617 746 961 877 69 21 77 4865 96  4  2 443  72 187 22 779 91  1 459 66 158 812 633 312 99    53 218 39 648 6271  292  61 165 738 92 48 331  59 361 964 42 663 11 235 62   38 67  1 25 98 281 18 72 6414  3 768 7992 11 41 49 467 11 533 595  5341 929 98 528 477  73 55 3179 934 19   82 714 1  316 69  8 487 45 59 717 4  98   2  23 149 61  325 95 3574 216  9 969  9 591 288 228  69 43 3838  97 326  3 17 1  96 71 18 53  8 33 354   365 689 188  34  9 9   56  62 39 588 23 84 4   321 9626 2629 47 224 1135 75 895  87  79 8423 42 651 35  82 836  77 47 112 95 724 285 876 389 35 16 653 44 1541 571 9  35 1892 738  51 1532 487 33 21 651 264 81 281 95 98 821 95  16 8  36  15  457 131 51  9 691 688 7544 54  34 727 315 293 384  88 49  635  82 79 773 865 84 46 62 4  71 398 17 88 57 72 716 274  518 81
      |  3 764 4592 46 94 43  589 67  83 933 466 475 684 3377 83 873 8357  2  12 3  19 3    44 54 37 882 16  39 772 9   39 717 3773 194 94 872 957 774  383 287 9785 225 9   63 6    9   5 31   2196 646 81  82 573 382 52 639   54   84 497 77 94  9 5692 6288 74 9   983 137 79 8617 272 61   49   3 2  65 943  998 693 118 45 32 777 2  49 81 6   61 12 9169 989 3353 95    7   63 95  9  9 5121  9 785 31 38  5 21  92  7 95 177 249 195 68    4 8276  123  6 97 8   442  12 636  29 54  8842 5797  333 1586 5   3 8    65  621 82  7 2  25 161 95 171 4   51    8 671 757 6  76 39  731 36 2848   98 523 449 69 68  26  11   6   9 8754 1   2  768 28 35 5  678 78    9 645 89  841 3836 9  8356 9223 47 84 154 76 17 844 75 46 8  919 9  837 356 118 33  81  6 66 918    8 78 4  81  3 269 992 99  72 2  669 62 857  675 751   46 91 44 34  6 59   15 35 489 97 261 377  12   2 2      6 93  962 3595 35 54 65  7323 41  1   6 2  6  214 569 111 228 522 984 128 9416 259 976 44 714 945 428 8   33  6 26 258 32  87 277 65 669 89 1  5785 92  77  13 62   961 24 623 8  94  898 95 797 64   25 34 17 239 136 8549 9   4  337   1 5478 833  94 9  72 12  11  9  836 9    616 43 286 1892 66  874 37 61 6    2 84 875 891 71 13 41 32 6496 13 34  7    58  2 69  29 19 881 96  9  365 473 129 6147 91 773 9161 527  316 837 43  483    5  8 83 88 263 446 6258 95 63  799 7  42 311 3   2  13 662 97 29 6635 643 916 572 1686  6 783  4 64  4545  5 885   2 93 196 5  14  2 62  9 332 818  1 597 2  741 43  54 928 96  758 89  21  89  4 16 85 15 42 65   7 9   3 16  5  44 2  675 489 59 19   2  28 15 71 59 4   493   4 1328  64 7    6  7 8  25  7  77 96 19 57 896 2  9698 352 46 149 91 4991 66 65 148 565  1 46 523 623 72  878 2397 95 55 319    56 1622 51 72 2  329 573 13 475 19  4 639 8268 1372 7  82 6   985 46 85 79 724 46 567 813 45 5  557 79 242 8   19 19 6276 388 2   88 6734 8  3334 81 76 5  67 52 4  26 7689 41 34  46 935 61  15 2279    9 97   8 78 75     96 5572 256 58 26 28 452 38 87   217 38 92   15 132 37 829 9634 664  2 6  82  47 67 683  433 69  271  816 78  2 762 9    2 72  82 36    42 518 3  32  4  9 2622 21  516 797 793 87   2 918 815 16 2   711 6  78 3    2 42  163 8482 964 5886  185  7  99   5 45 854 96 16  83 3764 956 193 448 4  36 98  15  21 67  77  3  238 4  32 53 876  22 388 5  96 331  9 728 1  5  366 615 29 21 44 94 396 84 9876 348 43  5459  9 96 14    5 55 42 597 95 276  921 62 28  317 983 572 987 9  27 17   845 241 4    5  753 7459 98 91 539 2768 81 276 67 79 69 93 47 11   38 61    41 85 6932 4    25 876  815  78  1 6168 17 74 978 4835 76  243 297 51 32 7   17 573 232 65 4142 46 878 276 845  656 863 765 12 64 853 996 56 93  43   222 1382 836  592 239 2537 44 4283 35 99 2   938 91 3    8785 485 74 71 1  59 62  6 1312 69 6689  4 31   91 977 76 91 57 99   49  875 89  28 37 9  93 378 2  81 472 644 231 21 172   52 84 742 34 16  85 43 6479 38 2422 2   36 56  74 951 5631 336  9 99 897 29 3  77 15  6289 48 5  289 8  59 839 3751   6  22  7 7  3    642   1 256   36 131 82  816 98 84  8 1133 59 36 38 78   76 244 38 114 85  1  21 39  78  55 35  898 8     73 743 44 276 7321  829 738 419 146 68 6  3    55 947 819 16 895 43 774 46   92 2   6  6 4  435 18 73 342   8 523 571   4 31 33 333 96   6 7489 96   126 38 457 62   94 93 3417 373 3    86  86 1  366 57  8 416 73 3  36  9  29   4 757 378 68  487 29 8692 336  4 795  6 564   8 198 739 34  344 254 35   4 5  9  63 63 52 7  69 38 9147 3748 165 437  93  5 2   28   1 84 734 24 71 9   872 9531 4745 56 93  4695 2  9   853   4 6471 29  84 1   96 357  64 24 18  19 616 158 843 589 75 23 74  35 1278 543 8  72 3987  68   3 8    22  87 21 712 326 91 515 1  1  372 35  72 11 49 754   42 517 91  7 439  13 7324 434  1 199 892 329 92   93 65    6  64 98 491 481  7 44 8  8  42 4   96 34 36 91  87  71   74 37
      |*   *   +    *  +  +  +    *  *   +   +   *   +   +    +  *   +    *  *   *  +  *  +    +  *  +   *   +  *   *   *  *   +    +   *  *   *   +    *   *   +    *   *  *   *   *  *   +    +    +   *  +   +   *   *  +   +    +    +   +  *  *  +    +    *  *   *   *   *  +    *   *  +    +   *  *  +   +    +   *   *  +  +   *  +  *  +   +  *  +    *   +    *   *   +    +  *  *  +    +  +   *  +  +  +   +  +  *  *   *   +   *   +   +    +    +  +  +   +    *  *   +   *   +    +    +    +    +  *  +    *   *   *  *  *  +  +   *  *   +  *   +    *   *   *  +  +  +    *  +    +    *   +   *  +   *   *   *  *   +    +   +  +   *  *  *  *   +  +    *   *   *   +    *  +    +    +  +  *   *  *  *   +  +  *  *   *  +   *   *   *   *  +  +  +   +    +  +  +  +  +   +   *  *   *  *   +  *   +    +   +    *  +  *  *  +    *  *  *   *  *   +   *   +   +    +   +   *   +    *  *  +   +    +  *  +   +  +  *   *   *   *   +   *   +   +    +   +   *  *   *   +   +  +   *  *  +   *  *   +   +  *   *  +  +    *   *   *  +    *   *  +   +  +   *   *  +   +    *  *  +  +   +   +    *   *  +   +   +    *   +   +  *  +   +   *  +   +   +    *  +   +    *  +    +  *  +  +   *  *   +   +  +  +  *  +    *  +   +    *  *  *   *  *  +   +   *  +   +   *   +    *  *   +    +    *   *   *   +   +    *  *  *  +   *   +    *  +  +    *  +  *   +   *  +  *   *  +  +    *   +   *   +    *  *   *  +   +    +  +   *   *  *   *  *  +  +  *  *   *   *  +   +  +   *  *   *   *  +    +  +   *   *  *  +  *  *  +  +   +  *  +  +  +   *  +   +   *  +   *  *   *  +  +  *   *   *   +    +   *   *  +  *  +  +  +   +  *  *  +   *  +    +   *  *   *  +    *  +  *   +   +  +  *   *   *  +    +    *  *  +    +    +    *  +  *  +   +   +  +   *  +  *   +    +    *  *  *   +   *  +  *  *   +  +   *   +  *  *   +  +   *   +  *  +    *   *   *  +    +  +    *  *  *  *  +  +  *  +    *  +   *  *   +  +   +    +    +  +   *  +    +    +    +   +  *  *  +   +  +    *   *  +    *  +   +  +   +    *   *  +  *  +   *  +   +    *   *   +    +  *  +   *   *  *  *   +   +    +   +  *  +  *  +    *   +   +   +   +  *   +   +   +  *   *   *  *  *   +  *   *   +    *   +    +    *  +   *   *  +   *  *   +  +    *   *   *   *  *  *   *  +   *  *   +  +    +  *  +  +    *  *   *  *  *   +  *   *  *  +   *   *  *  +  *  +   *  +    +   +   +    +  +  *  +    +  +  *   *  +    +   *  +  +    *   *   *   +  +  +    *   +   *  *   +    +    *  +  +   +    *  +   +  *  *  *  *  +    +  *   +    *  +    +   *   +   +    *   *  +    *  +  *   +    *   *   +   *  *  *  +   *   *   *  +    +  *   +   *   +    +   *   *  *  *   +   +  +   +    *   +    *   +    *   +    +  +    +  *  *   *   *  +    +    *   *  *  *  *  *  +  +    *  +    *  *   +   +   +  *  +  +    *  +    *  *   *  *  *  *   *  +  *   *   +   *  *   +    *  +   *  +  *   *  +    +  +    +   *  *  *   *   +    *   +  *  *   +  *  *  *   +    +  *  *   +  *  +   +    *   *   *  *  +    +    *  +   +    *   *   +   *  +  *  +    *  +  +  +    +  +   *  *   +  *  *   *  *   +   *   *   *   +    +   +  *   +    +    *   +   +   +  +  +   *   *   *   *  +   *  *   +    +  +  +  +  *  +   +  +  +    *  *   +    +  *  *  *   *  *   +    +    +   +  +   +    *  *  +    +   *   *   +   +  *   *  +  *   +  +  *   *  *  *   *   *   +   *   +  +    +   +  *   +  *   +   *   *   +  +    +   +   +  +  +  *  +  +  +  *  +  +    +    +   *   +   *  *   +  *   *  +   *  *  *   +   +    +    *  +   +    *  *   *   +   +    *  +   *   +  *   +   *  +   *  +   *   +   *   *  +  +   +  +    *   *  *  +    *   *   +    *   *  +  +   *   *  *   +  *  *   *   *  +  *  +   +    *   +  *  *   *   +    +   *  *   *   +   +    +  *  +    +   *  +   +   *  +  *  *  +  *   +  *  *  +  +   *   +    * """.stripMargin
