package aoc
package y2023

object Day11:
  private def galaxy(input: String): Set[Coord] =
    (for
      (line, y) <- input.linesIterator.zipWithIndex
      x         <- line.zipWithIndex.collect { case ('#', x) => x }
    yield Coord(x, y)).toSet

  def solve(input: String, factor: Long = 1L): Long =
    val glxy = galaxy(input)

    val expand =
      glxy.map: c =>
        Coord(
          x = c.x + factor * (0L until c.x).count(x => !glxy.exists(_.x == x)),
          y = c.y + factor * (0L until c.y).count(y => !glxy.exists(_.y == y))
        )

    val coords = expand.toVector
    (for
      (coord, i) <- coords.zipWithIndex
      j          <- (i + 1) until coords.size
    yield coord.manhattan(coords(j))).sum

  def solve2(input: String): Long = solve(input, 999999L)

  val input =
    """.#...........#.........................................................................#...............#...........#........................
      |.......................#....................................................................................................................
      |...............................#...........#.................#.............................#.............................................#..
      |......#............................................#........................................................................................
      |......................................................................#.....#.....................#.........................................
      |.................#.......#.......................................#................#.....#.....................#.............................
      |.........................................#.................#................................................................................
      |................................#.............................................................#..........#..................................
      |#.......................................................................#..............................................#.................#..
      |..........#....................................#......................................#............................................#........
      |................#....................................#........#.............................................................................
      |......#........................................................................#............................................................
      |......................#..............#..............................................................#..........#.....#......................
      |..................................................#.......................#..................................................#..........#...
      |............................#...............................................................................................................
      |........#...................................................................................................................................
      |..................#.......................#................................................................#................................
      |.............................................................#........#.....................................................................
      |..............................#.......#......................................#.............#........................#.......................
      |.#............................................................................................................#...........................#.
      |...................................................................................................#....................#...................
      |....................#......................#.............#.....#..................................................................#.........
      |.................................................................................................................#..........................
      |............................................................................................................................................
      |....................................................................#.....................#.................................................
      |.................................#..............................................#..............#............#.............#.................
      |...........................#............................................#...........................................#.......................
      |......................#.........................#...........................................................................................
      |.......................................#....................................#...................................#...........................
      |.....#..........#.........................................#...............................................................................#.
      |#..........#......................#...................................................#.......#.....#.......................................
      |.........................#..................................................................................................................
      |....................#..............................#.............#.........................................#.......#........#...............
      |...........................................#........................................................................................#.......
      |...........................................................#....................#...........................................................
      |..........#....................................................................................................#............................
      |...............#................................#..........................#..............................................................#.
      |..#.................................#.................................................................#.......................#.............
      |.....................#......#...............#........................#................................................#.....................
      |..............................................................................................#....................................#........
      |................................#.......#...................................................................................................
      |..........#................................................#...................#.....#..............#..........#..........#.................
      |.........................#..................................................................................................................
      |..................#...............................#...........................................................................#.............
      |.........................................................................#............................................#.....................
      |........#.....#..............................................................................#.........#..................................#.
      |.#...............................#......#............#.............................................................................#........
      |....................................................................................#.............#...............#........#................
      |...........................#................................................................................................................
      |......................#..................................#..............#................................#.............#................#...
      |...............................................................#..............#.............................................................
      |..................................#........................................................#........#.......................................
      |......#.................................#.......#....................#...............................................................#......
      |.................#............#..............................................................................#.............................#
      |............................................................................................................................................
      |..#.....................#.............................................................................#.....................................
      |.......................................................................................#..............................#.....................
      |...............................................................................#.............#..............................................
      |....................#.....................#...............................................................#.................................
      |..........#........................#............#...................#.............................................#...............#.........
      |............................#.............................#..........................#......................................................
      |...........................................................................................#................................................
      |.................................................................#.................................#.........................#........#.....
      |.................#........................................................#..................................#..............................
      |......................................#......................#..............................................................................
      |.............#...........#...............................................................................#..........#.......................
      |.................................#...........#...........................................................................#..............#...
      |.......#............................................#.....#....................#..............#.....#.......................................
      |...................#...........................................#................................................#...........................
      |........................................................................................#...................................................
      |...#....................#.....#............#.........................................................................................#......
      |...............#.............................................................#..................#........#................#.................
      |.........#.....................................#............................................................................................
      |................................................................................................................................#...........
      |.....................#.............#.........................................................................#..............................
      |.....#...............................................................................................................#..............#......#
      |...........#.......................................#.....#.................#.................#..............................................
      |............................................................................................................................................
      |.#.......................................#..........................................#................#......................................
      |......................#.............#.................#.......................#...........#.............................#...................
      |...............#.............#................................#......#.......................................................#..............
      |............................................................................................................................................
      |...#............................................................................................#....................#......................
      |..........#.....................#.............................................................................#.............................
      |...........................#...............................................................................................#...............#
      |.....................#......................................#.......#......#........#..................#...........................#........
      |.....#...............................#............#.........................................................................................
      |............................................................................................................................................
      |.........................................................#........................................................#.........................
      |#..............................#..........#..............................................................................#................#.
      |....................#..............................................#.......................#.........#......................................
      |............................................................................................................................................
      |...........#.......................................#.............................................................................#..........
      |...#......................#...............................................#......................#..........................................
      |..................#.........................................................................................................................
      |...........................................................#........#...........#.....#......#........................#.................#...
      |........#...................................................................................................................................
      |....................................................................................................#......#................................
      |................................#...........#....................#.....#...................................................#........#.......
      |........................#............#......................................#.............#.................................................
      |...................#............................................................................................#...........................
      |#................................................................................................................................#..........
      |..............#.............................................#...............................................................................
      |..............................#...............................................#.................#......................................#....
      |....#....................#......................................#...................#...............................#.......#...............
      |........................................#..........#........................................#................#..............................
      |............................................................................................................................................
      |............................................................................................................................................
      |........................................................................................................................................#...
      |...........................................................#..................#.................#.................#.........................
      |.......#........................................................#................................................................#..........
      |..........................#......#......#..................................................................................#................
      |...............................................#.....#.................#....................................................................
      |......................................................................................................#.....................................
      |................#....................#.....................................................................#........#.......................
      |..............................................................................................................................#.............
      |...........................................#.............................................................................................#..
      |....#........................#..............................#.............#................#................................................
      |......................#..........................................................................................#......#...................
      |....................................................#................................#.........#............................................
      |..........................#.......................................#.........................................................................
      |.................#........................#.....#........................................................#..................................
      |.#.........................................................#............#....................................................#..............
      |..........#..................#.....#..................................................................................................#.....
      |.................................................................................#..........................................................
      |.....................................................#....................................#.........#...........#.....#.....................
      |.............................................#.....................#.......................................#.......................#........
      |................................#...........................................................................................................
      |......#........................................................#..............................#.............................................
      |............#......................................#.....#............................#........................................#............
      |............................................................................#...............................................................
      |.......................................#...............................#...................#..............................#...........#.....
      |.......................#..............................#..........................#..............................#...........................
      |.................................................................#...................................#......................................
      |......................................................................................................................#...................#.
      |.................#..........................................................................................................................
      |.........#......................#.....#...........#.......................................................#.................................
      |...........................................#.................#................#.....................................................#.......
      |..#...............................................................#.........................................................................
      |.....................#......#......#.............................................................#............#...........#.................""".stripMargin
